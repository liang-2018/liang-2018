<!-- build time:Mon Dec 09 2019 22:53:03 GMT+0800 (GMT+08:00) --><!DOCTYPE html><html class="theme-next gemini use-motion" lang="zh-Hans"><head><meta name="generator" content="Hexo 3.8.0"><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1"><meta name="theme-color" content="#222"><script src="/lib/pace/pace.min.js?v=1.0.2"></script><link href="/lib/pace/pace-theme-minimal.min.css?v=1.0.2" rel="stylesheet"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css"><link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css"><link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css"><link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.4"><link rel="icon" type="image/png" sizes="32x32" href="/images/head-32x32.png?v=5.1.4"><link rel="icon" type="image/png" sizes="16x16" href="/images/head-16x16.png?v=5.1.4"><link rel="mask-icon" href="/images/logo.svg?v=5.1.4" color="#222"><meta name="keywords" content="MySQL,"><meta name="description" content="MySQL 基础学习笔记，主要是相关查询语句、事务、存储过程与函数等。"><meta name="keywords" content="MySQL"><meta property="og:type" content="article"><meta property="og:title" content="MySQL 基础 学习笔记"><meta property="og:url" content="https://pengshiliang.coding.me/2018/08/20/MySQL学习笔记/index.html"><meta property="og:site_name" content="初心不忘"><meta property="og:description" content="MySQL 基础学习笔记，主要是相关查询语句、事务、存储过程与函数等。"><meta property="og:locale" content="zh-Hans"><meta property="og:image" content="https://pengshiliang.coding.me/2018/08/20/MySQL学习笔记/1560222802298.png"><meta property="og:image" content="https://pengshiliang.coding.me/2018/08/20/MySQL学习笔记/1560420853640.png"><meta property="og:image" content="https://pengshiliang.coding.me/2018/08/20/MySQL学习笔记/1560420881506.png"><meta property="og:image" content="https://pengshiliang.coding.me/2018/08/20/MySQL学习笔记/1562751140613.png"><meta property="og:image" content="https://pengshiliang.coding.me/2018/08/20/MySQL学习笔记/1562769406463.png"><meta property="og:updated_time" content="2019-07-24T08:55:33.474Z"><meta name="twitter:card" content="summary"><meta name="twitter:title" content="MySQL 基础 学习笔记"><meta name="twitter:description" content="MySQL 基础学习笔记，主要是相关查询语句、事务、存储过程与函数等。"><meta name="twitter:image" content="https://pengshiliang.coding.me/2018/08/20/MySQL学习笔记/1560222802298.png"><script type="text/javascript" id="hexo.configurations">var NexT=window.NexT||{},CONFIG={root:"/",scheme:"Gemini",version:"5.1.4",sidebar:{position:"left",display:"always",offset:12,b2t:!1,scrollpercent:!1,onmobile:!1},fancybox:!0,tabs:!0,motion:{enable:!0,async:!1,transition:{post_block:"fadeIn",post_header:"slideDownIn",post_body:"slideDownIn",coll_header:"slideLeftIn",sidebar:"slideUpIn"}},duoshuo:{userId:"0",author:"博主"},algolia:{applicationID:"",apiKey:"",indexName:"",hits:{per_page:10},labels:{input_placeholder:"Search for Posts",hits_empty:"We didn't find any results for the search: ${query}",hits_stats:"${hits} results found in ${time} ms"}}}</script><link rel="canonical" href="https://pengshiliang.coding.me/2018/08/20/MySQL学习笔记/"><title>MySQL 基础 学习笔记 | 初心不忘</title></head><body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans"><div class="container sidebar-position-left page-post-detail"><div class="headband"></div><header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="header-inner"><div class="site-brand-wrapper"><div class="site-meta custom-logo"><div class="custom-logo-site-title"><a href="/" class="brand" rel="start"><span class="logo-line-before"><i></i></span> <span class="site-title">初心不忘</span> <span class="logo-line-after"><i></i></span></a></div><p class="site-subtitle"></p></div><div class="site-nav-toggle"><button><span class="btn-bar"></span> <span class="btn-bar"></span> <span class="btn-bar"></span></button></div></div><nav class="site-nav"><ul id="menu" class="menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="menu-item-icon fa fa-fw fa-home"></i><br>首页</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="menu-item-icon fa fa-fw fa-archive"></i><br>归档</a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="menu-item-icon fa fa-fw fa-tags"></i><br>标签</a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="menu-item-icon fa fa-fw fa-th"></i><br>分类</a></li><li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="menu-item-icon fa fa-fw fa-user"></i><br>关于</a></li><li class="menu-item menu-item-search"><a href="javascript:;" class="popup-trigger"><i class="menu-item-icon fa fa-search fa-fw"></i><br>搜索</a></li></ul><div class="site-search"><div class="popup search-popup local-search-popup"><div class="local-search-header clearfix"><span class="search-icon"><i class="fa fa-search"></i> </span><span class="popup-btn-close"><i class="fa fa-times-circle"></i></span><div class="local-search-input-wrapper"><input autocomplete="off" placeholder="搜索..." spellcheck="false" type="text" id="local-search-input"></div></div><div id="local-search-result"></div></div></div></nav></div></header><main id="main" class="main"><div class="main-inner"><div class="content-wrap"><div id="content" class="content"><div id="posts" class="posts-expand"><article class="post post-type-normal" itemscope itemtype="http://schema.org/Article"><div class="post-block"><link itemprop="mainEntityOfPage" href="https://pengshiliang.coding.me/2018/08/20/MySQL学习笔记/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="name" content="Liang"><meta itemprop="description" content><meta itemprop="image" content="/images/head-32x32.png"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="初心不忘"></span><header class="post-header"><h1 class="post-title" itemprop="name headline">MySQL 基础 学习笔记</h1><div class="post-meta"><i class="fa fa-thumb-tack"></i> <font color="7D26CD"></font> <span class="post-meta-divider">|</span> <span class="post-time"><span class="post-meta-item-icon"><i class="fa fa-calendar-o"></i> </span><span class="post-meta-item-text">发表于</span> <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-08-20T11:44:39+08:00">2018-08-20 </time></span><span class="post-category"><span class="post-meta-divider">|</span> <span class="post-meta-item-icon"><i class="fa fa-folder-o"></i> </span><span class="post-meta-item-text">分类于</span> <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/MySQL/" itemprop="url" rel="index"><span itemprop="name">MySQL</span> </a></span></span><span class="post-comments-count"><span class="post-meta-divider">|</span> <span class="post-meta-item-icon"><i class="fa fa-comment-o"></i> </span><a href="/2018/08/20/MySQL学习笔记/#comments" itemprop="discussionUrl"><span class="post-comments-count valine-comment-count" data-xid="/2018/08/20/MySQL学习笔记/" itemprop="commentCount"></span></a></span></div></header><div class="post-body" itemprop="articleBody"><blockquote><p>MySQL 基础学习笔记，主要是相关查询语句、事务、存储过程与函数等。</p></blockquote><a id="more"></a><h2 id="一、相关基础"><a href="#一、相关基础" class="headerlink" title="一、相关基础"></a>一、相关基础</h2><h3 id="1、相关概念"><a href="#1、相关概念" class="headerlink" title="1、相关概念"></a>1、相关概念</h3><p>DB: database，分为两类，服务端、客户端</p><p>DBMS: Database Management System</p><p>SQL: Structure Query Language</p><h3 id="2、安装、环境配置等-略"><a href="#2、安装、环境配置等-略" class="headerlink" title="2、安装、环境配置等(略)"></a>2、安装、环境配置等(略)</h3><h3 id="3、优点"><a href="#3、优点" class="headerlink" title="3、优点"></a>3、优点</h3><ul><li>持久化数据</li><li>结构化查询，方便管理</li><li>开放源代码</li><li>性能高</li><li>安装、使用简单</li></ul><h3 id="4、配置文件"><a href="#4、配置文件" class="headerlink" title="4、配置文件"></a>4、配置文件</h3><p>my.ini</p><blockquote><p>配置服务器参数，修改后，重启服务生效。</p></blockquote><h3 id="5、连接"><a href="#5、连接" class="headerlink" title="5、连接"></a>5、连接</h3><blockquote><ul><li>-h: 主机ip，需要有空格</li><li>-P: 端口号，需要空格</li><li>-u：用户名，不需空格</li><li>-p：密码，可明文输入，也可密文输入</li></ul><p>本机连接时，中括号部分为可选部分</p></blockquote><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysql [-h localhost -P 3306] -uroot -p</span><br></pre></td></tr></table></figure><h3 id="6、MySQL语法规范"><a href="#6、MySQL语法规范" class="headerlink" title="6、MySQL语法规范"></a>6、MySQL语法规范</h3><ul><li>不区分大小写，建议关键字大写，表名、列名小写</li><li>每条命令最好以分号结尾</li><li>每条命令根据需要进行缩行、换行</li><li>注释<ul><li>单行注释 ： # 注释文字</li><li>单行注释 ： — 注释文字,—后必须有空格</li><li>多行注释 ：与Java注释一致</li></ul></li></ul><h3 id="7、常见命令"><a href="#7、常见命令" class="headerlink" title="7、常见命令"></a>7、常见命令</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"># 查看数据库 databases</span><br><span class="line"># 注意，自带数据库， infomation_schema,mysql, performance_schema 不能删除</span><br><span class="line">show databases;</span><br><span class="line"># 使用指定数据库</span><br><span class="line">use test;</span><br><span class="line"># 查看当前使用的数据库</span><br><span class="line">select database();</span><br><span class="line"># 查看数据中的表</span><br><span class="line">show tables;</span><br><span class="line">show tables from database_name;</span><br><span class="line"># 查看表结构 describe</span><br><span class="line">desc table_name;</span><br><span class="line"># 查看服务器版本</span><br><span class="line">select version();</span><br><span class="line"># 未进入mysqlshell时</span><br><span class="line">mysql --version</span><br><span class="line">mysql -V</span><br></pre></td></tr></table></figure><h2 id="二、DQL-Data-Query-Language"><a href="#二、DQL-Data-Query-Language" class="headerlink" title="二、DQL(Data Query Language)"></a>二、DQL(Data Query Language)</h2><h3 id="1、基础查询、条件查询"><a href="#1、基础查询、条件查询" class="headerlink" title="1、基础查询、条件查询"></a>1、基础查询、条件查询</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"># 对于中文，可以使用``(反引号)隔开</span><br><span class="line">SELECT __cols__ FROM table_name;</span><br><span class="line"># as 起别名</span><br><span class="line">SELECT CONCAT(name1,name2) AS name FROM table_name;</span><br><span class="line">SELECT CONCAT(name1,name2) name FROM table_name;</span><br><span class="line"># 去重</span><br><span class="line">SELECT DISTINCT name FROM table_name;</span><br><span class="line"># + 符号的作用：仅有运算符作用，所以对列用 + 连接，会自动转换字段值并当做数值运算，若转换失败，将字符值置0处理，</span><br><span class="line"># 进行数据连接时，若其中一方为null，则结果为null</span><br><span class="line"># null 排除，IFNULL(null_col, value2replace),如果null_col某行为NULL，则替换为value2replace</span><br><span class="line">SELECT IFNULL(nickname, &quot;&quot;), nickname FROM table_name;</span><br><span class="line"># 条件查询，条件运算符中,不等于使用 &lt;&gt; ；逻辑运算符  and or not</span><br><span class="line">SELECT name FROM employee WHERE NOT(age &gt;20 AND sex=&quot;male&quot;);</span><br></pre></td></tr></table></figure><blockquote><p>like 一般配合通配符使用</p><ul><li>% 任意多个字符，包含0个字符</li><li>_ 任意单个字符</li></ul><p>转义字符</p><ul><li>\</li><li>使用ESCAPE 指定转义字符</li></ul></blockquote><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"># 模糊查询 like, between and, in, is null</span><br><span class="line">SELECT name FROM employee WHERE name like &apos;%he%&apos;;</span><br><span class="line">SELECT name FROM employee WHERE name like &apos;_$_he%&apos; ESCAPE &apos;$&apos;;</span><br><span class="line"># 区间查找，包含区间两端值 [20,100]</span><br><span class="line">SELECT name FROM employee WHERE salary BETWEEN 20 AND 100;</span><br><span class="line"># 多个值选择,但是括号中的值必须相同或者兼容</span><br><span class="line">SELECT name FROM empolyee WHERE name IN(&quot;Jack&quot;, &quot;Jane&quot;, &quot;Mars&quot;)；</span><br><span class="line"># MySQL 中 =  &lt;&gt; 号不能判断NULL值，必须使用 IS NULL	来判断</span><br><span class="line">SELECT name FROM empolyee WHERE nickname IS NULL；</span><br><span class="line">SELECT name FROM empolyee WHERE nickname IS NOT NULL；</span><br><span class="line"># 安全等于 &lt;=&gt; 安全等于功能比较好，NULL和普通值都可以比较，但是可读性不强</span><br><span class="line">SELECT name FROM empolyee WHERE salary &lt;=&gt; 12000</span><br><span class="line">SELECT name FROM empolyee WHERE nickname IS NULL；</span><br></pre></td></tr></table></figure><h3 id="2、排序查询"><a href="#2、排序查询" class="headerlink" title="2、排序查询"></a>2、排序查询</h3><blockquote><p>SELECT [COLS] FROM table_name WHERE […..] ORDER BY _order_cols [ASC|DESC]</p><p>order by 可以支持单个字段、多个字段、表达式、函数、别名，一般，order by 与 limit 放在语句最后面</p><ul><li>ASC: 升序，ascend，如果不写 默认为升序</li><li>DESC:降序 descend</li></ul></blockquote><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SELECT * FROM employee ORDER BY salary DESC</span><br></pre></td></tr></table></figure><h3 id="3、常用函数"><a href="#3、常用函数" class="headerlink" title="3、常用函数"></a>3、常用函数</h3><h4 id="（1）字符函数"><a href="#（1）字符函数" class="headerlink" title="（1）字符函数"></a>（1）字符函数</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"># 字符占的字节长度</span><br><span class="line">SELECT LENGTH(&apos;一个中文汉字占3个字节&apos;)</span><br><span class="line"># 字符拼接</span><br><span class="line">SELECT CONCAT(name1,name2) AS name FROM table_name;</span><br><span class="line"># UPPER LOWER 字符大小写转换</span><br><span class="line">SELECT CONCAT(UPPER(name1),LOWER(name2)) AS name FROM table_name;</span><br><span class="line"># substr substring  子字符串，注意的是，索引是从1开始计数的，包左且包右，是 [] 集合</span><br><span class="line">SELECT SUBSTR(&apos;一个中文汉字占3个字节&apos;, 3) `SUBSTRING` # 结果为 中文汉字占3个字节</span><br><span class="line">SELECT SUBSTR(&apos;一个中文汉字占3个字节&apos;, 3, 4) `SUBSTRING` # 结果为 中文</span><br><span class="line"># instr 返回子串第一次出现的素银，如果找不到返回0</span><br><span class="line">SELECT INSTR(&apos;一个中文汉字占3个字节&apos;, &apos;中文&apos;) # 结果 3</span><br><span class="line"># trim 去除空格，去除指定字符</span><br><span class="line">SELECT TRIM(&apos;  中文   &apos;)   # 结果为中文</span><br><span class="line">SELECT TRIM(&apos;a&apos; from &apos;aaaaa中文aa英文aaa&apos;)   # 结果为  中文aa英文</span><br><span class="line"># lpad  用指定字符实现左填充指定长度</span><br><span class="line">SELECT LPAD(&apos;中文&apos;, 3, &apos;A&apos;)   # 结果为 AAA中文</span><br><span class="line"># rpad  用指定字符实现右填充指定长度</span><br><span class="line">SELECT RPAD(&apos;中文&apos;, 3, &apos;A&apos;)   # 结果为 中文AAA</span><br><span class="line"># replace 替换字符</span><br><span class="line">SELECT REPLACE(&apos;中文英文中文英文&apos;, &apos;英文&apos;, &apos;汉语&apos;)  # 结果   中文汉语中文汉语</span><br></pre></td></tr></table></figure><h4 id="（2）数学函数"><a href="#（2）数学函数" class="headerlink" title="（2）数学函数"></a>（2）数学函数</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"># round 四舍五入</span><br><span class="line">SELECT ROUND(1.657)</span><br><span class="line">SELECT ROUND(1.657, 2) # 保留两位小数，1.66</span><br><span class="line"># ceil 向上去整, 大于等于原数值的整数</span><br><span class="line">SELECT CEIL(1.657)</span><br><span class="line"># floor 向下去整，小于等于原数值的整数</span><br><span class="line">SELECT FLOOR(1.657)</span><br><span class="line"># truncate 截断</span><br><span class="line">SELECT TRUNCATE(1.657, 1) # 1.6</span><br><span class="line"># mod 取余, mod(a,b)= a - a/b * b</span><br><span class="line">SELECT MOD(-10, -3) # -1</span><br><span class="line">SELECT -10%3 # -1</span><br></pre></td></tr></table></figure><h4 id="（3）日期函数"><a href="#（3）日期函数" class="headerlink" title="（3）日期函数"></a>（3）日期函数</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">SELECT NOW(); # 返回当前时间 2018-06-11 11:03:16</span><br><span class="line">SELECT CURDATE(); # 返回当前系统日期 2018-06-11</span><br><span class="line">SELECT CURTIME(); # 返回当前时间，不包含日期  11:05:14</span><br><span class="line"># 获取时间的指定部分 year month day  hour minute second HOUR_MINUTE</span><br><span class="line">SELECT YEAR(NOW()); </span><br><span class="line">SELECT MONTH(NOW()); </span><br><span class="line">SELECT MONTHNAME(NOW()); </span><br><span class="line">SELECT HOUR_MINUTE(NOW()); </span><br><span class="line"># 将日期格式的字符转换为指定格式的日期 STR_TO_DATE(str,format)</span><br><span class="line">SELECT STR_TO_DATE(&apos;2018-6-11&apos;,&apos;%Y-%c-%d&apos;); # 2018-06-11</span><br><span class="line"># 将日期转换为指定格式 DATE_FORMAT(date,format)</span><br><span class="line">SELECT DATE_FORMAT(NOW(),&apos;%Y年%c月%d日&apos;) # 2018年6月11日</span><br></pre></td></tr></table></figure><p><img src="/2018/08/20/MySQL学习笔记/1560222802298.png" alt="1560222802298"></p><h4 id="（4）其他函数"><a href="#（4）其他函数" class="headerlink" title="（4）其他函数"></a>（4）其他函数</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"># 版本号</span><br><span class="line">select VERSION();</span><br><span class="line"># 当前使用的数据库</span><br><span class="line">SELECT DATABASE();</span><br><span class="line"># 当前连接的用户名</span><br><span class="line">SELECT USER() # root@Liang-PC</span><br></pre></td></tr></table></figure><h4 id="（5）流程控制函数"><a href="#（5）流程控制函数" class="headerlink" title="（5）流程控制函数"></a>（5）流程控制函数</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"># IF(expr1,expr2,expr3) 类似三元运算符</span><br><span class="line">select `name` IF(salary IS NULL, &apos;值异常&apos;, &apos;值正常&apos;)</span><br><span class="line"># case 和Java中的switch...case...效用一致，但是只用用于等值判断</span><br><span class="line">SELECT `姓名`,`数学`,</span><br><span class="line">CASE `数学`</span><br><span class="line">	WHEN 100 THEN &quot;满分&quot;</span><br><span class="line">	WHEN 90 THEN &quot;合格&quot;</span><br><span class="line">	ELSE &quot;其他&quot;</span><br><span class="line">END AS 是否及格</span><br><span class="line">FROM `month_test_1`；</span><br><span class="line"># 类似多重if</span><br><span class="line">SELECT `姓名`,`语文`,</span><br><span class="line">CASE </span><br><span class="line">	WHEN `语文`&lt;60.0 THEN &quot;不及格&quot;</span><br><span class="line">	WHEN `语文`&gt;=60.0 and `语文`&lt; 70 THEN &quot;合格&quot;</span><br><span class="line">	WHEN `语文`&gt;=70.0 and `语文`&lt; 80 THEN &quot;良好&quot;</span><br><span class="line">	ELSE &quot;优秀&quot;</span><br><span class="line">END AS 等级</span><br><span class="line">FROM `month_test_1`；</span><br></pre></td></tr></table></figure><h4 id="（6）分组函数"><a href="#（6）分组函数" class="headerlink" title="（6）分组函数"></a>（6）分组函数</h4><blockquote><ul><li><p>sum ：默认忽略null值</p></li><li><p>avg ：默认忽略null值</p><p>sum avg 参数支持类型：仅数值</p></li><li><p>max</p></li><li><p>min</p></li><li><p>count：默认忽略null值</p></li></ul><p>分组函数可以和 distinct搭配使用<br>一般和分组函数一起查询的字段，要求是group by 后的字段</p></blockquote><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">SELECT SUM(`语文`),AVG(`语文`),MAX(`语文`),MIN(`语文`), count(`语文`)</span><br><span class="line">FROM `month_test_1`；</span><br></pre></td></tr></table></figure><blockquote><p>count 效率</p><ul><li><p>MYISAM 存储引擎 : count(*)效率最高</p></li><li><p>INNODEB 存储引擎 : count(*)与count(1)效率差不多，比count(字段)要高</p></li></ul></blockquote><h3 id="4、分组查询"><a href="#4、分组查询" class="headerlink" title="4、分组查询"></a>4、分组查询</h3><blockquote><p>select 分组函数，列<br>from 表<br>where 条件<br>group by 分组的列<br>having 分组筛选条件<br>order by 列</p><p><strong>注意：</strong>查询列一般要求和group by后的列字段一致</p></blockquote><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SELECT count(*) as total, gname FROM `terrorismdb_zh` GROUP BY gname HAVING total&gt;40 ORDER BY total DESC</span><br></pre></td></tr></table></figure><h3 id="5、连接查询"><a href="#5、连接查询" class="headerlink" title="5、连接查询"></a>5、连接查询</h3><blockquote><p>笛卡尔乘积现象<br>原因：没有有效的连接条件</p><ul><li>内连接 inner<ul><li>等值连接</li><li>非等值连接</li><li>自连接</li></ul></li><li>外连接<ul><li>左外连接 left join，左边的是主表</li><li>右外连接 right join，右边的是主表</li><li>全外连接 full join，= 内连接结果+表1没有但是表2有+表1有但是表2没有</li></ul></li><li>交叉连接 cross</li></ul></blockquote><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"># 等值连接,注意的是，如果为表起了别名，查询字段时就不能使用原来的表名。</span><br><span class="line">SELECT en.country_txt,zh.country_txt   FROM terrorismdb_en en, terrorismdb_zh zh WHERE en.eventid = zh.eventid;</span><br><span class="line"># 非等值连接，相当于等于号换成非等于号关系。</span><br><span class="line"># 自连接， 表与自己进行连接筛选</span><br></pre></td></tr></table></figure><blockquote><p><strong>内外连接</strong> 查询格式</p><p>select 查询列表<br>from table_1 [连接类型]<br>join table_2 on 连接条件<br>[where 筛选条件]<br>[group by]<br>[order by]</p><p><strong>内连接</strong></p></blockquote><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"># 等值连接，join可以有多个，连接多个表； 非等值连接、自连接同理</span><br><span class="line">SELECT en.country_txt,zh.country_txt </span><br><span class="line">FROM terrorismdb_en en INNER JOIN terrorismdb_zh zh </span><br><span class="line">ON en.eventid = zh.eventid;</span><br></pre></td></tr></table></figure><blockquote><p><strong>外连接</strong></p><p>1、外连接查询结果为主表中的所有记录，</p><ul><li>如果从表中没有和它匹配的，则显示null</li><li>如果从表中游和它匹配的，显示匹配的值</li></ul></blockquote><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">SELECT en.eventid, en.country_txt, zh.eventid, zh.country_txt </span><br><span class="line">FROM terrorismdb_en en LEFT OUTER JOIN terrorismdb_zh zh </span><br><span class="line">ON en.eventid = zh.eventid;</span><br><span class="line">SELECT en.eventid, en.country_txt, zh.eventid, zh.country_txt </span><br><span class="line">FROM terrorismdb_en en RIGHT OUTER JOIN terrorismdb_zh zh </span><br><span class="line">ON en.eventid = zh.eventid;</span><br><span class="line"># 全连接，mysql不支持</span><br><span class="line">SELECT en.eventid, en.country_txt, zh.eventid, zh.country_txt </span><br><span class="line">FROM terrorismdb_en en FULL JOIN terrorismdb_zh zh </span><br><span class="line">ON en.eventid = zh.eventid;</span><br><span class="line"># 改成如下等效 全连接</span><br><span class="line">SELECT * FROM terrorismdb_zh zh LEFT JOIN terrorismdb_en en on zh.eventid= en.eventid</span><br><span class="line">UNION</span><br><span class="line">SELECT * FROM terrorismdb_zh zh RIGHT JOIN terrorismdb_en en on zh.eventid= en.eventid</span><br></pre></td></tr></table></figure><blockquote><p>交叉连接<br>笛卡尔乘积表格</p></blockquote><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SELECT * FROM terrorismdb_zh CROSS JOIN terrorismdb_en</span><br></pre></td></tr></table></figure><p><img src="/2018/08/20/MySQL学习笔记/1560420853640.png" alt="1560420853640"></p><p><img src="/2018/08/20/MySQL学习笔记/1560420881506.png" alt="1560420881506"></p><h3 id="6、子查询"><a href="#6、子查询" class="headerlink" title="6、子查询"></a>6、子查询</h3><blockquote><p>出现在其他语句中的select语句，称为子查询和内查询<br>内部签到其他的select语句的查询，称为外查询或主查询</p><p>特点：</p><ol><li>子查询一般放在小括号内</li><li>子查询一般放在条件右侧</li><li>标量子查询一般搭配单行操作符、运算符使用</li><li>子查询优先于子查询执行</li></ol><p>分类：</p><p>出现的位置：</p><ul><li>select 后面 仅支持标量子查询</li><li>from 后面 支持表子查询</li><li>where 或 having 后面 支持标量子查询，行、列子查询</li><li>exists 后面 支持表子查询</li></ul><p>结果的行列数：</p><ul><li>标量子查询 (结果集只有一行或者一列)</li><li>列子查询 （结果集为一列多行）</li><li>行子查询 （结果集为一行多列）</li><li>表子查询 （结果集一般为多行多列）</li></ul><p>① 单行子查询<br>结果集只有一行<br>一般搭配单行操作符使用：&gt; &lt; = &lt;&gt; &gt;= &lt;=<br>非法使用子查询的情况：<br>a、子查询的结果为一组值<br>b、子查询的结果为空</p><p><strong>非法使用子查询的情况：</strong><br>a、子查询的结果为一组值<br>b、子查询的结果为空</p><p>② 多行子查询<br>结果集有多行<br>一般搭配多行操作符使用：any、all、in、not in<br>in： 属于子查询结果中的任意一个就行<br>any和all往往可以用其他查询代替</p></blockquote><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"># 标量子查询 伤亡大于某事件伤亡数的事件</span><br><span class="line">SELECT * FROM terrorism_en where n_kill &gt; (</span><br><span class="line">    SELECT kill from FROM terrorism_en where eventid = 201704020001</span><br><span class="line">)；</span><br><span class="line"># 列子查询</span><br><span class="line">SELECT * FROM terrorism_en where n_kill in (</span><br><span class="line">    SELECT DISTINCT kill from FROM terrorism_en where eventid &gt; 201704020001</span><br><span class="line">)；</span><br></pre></td></tr></table></figure><div class="table-container"><table><thead><tr><th>操作符</th><th>含义</th></tr></thead><tbody><tr><td>IN/NOT IN</td><td>等于列表中的任意一个</td></tr><tr><td>ANY \</td><td>SOME</td><td>和子查询返回的某一个值比较,IN和 =ANY 效果类似</td></tr><tr><td>ALL</td><td>和子查询返回的所有值比较</td></tr></tbody></table></div><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"># where 或 having 后面</span><br><span class="line">SELECT gname,count(*) as count</span><br><span class="line">FROM terrorismdb_en </span><br><span class="line">GROUP BY gname </span><br><span class="line">HAVING count &gt;(</span><br><span class="line">	SELECT count(*) FROM terrorismdb_en WHERE gname=&quot;Left-Wing Militants&quot;</span><br><span class="line">);</span><br></pre></td></tr></table></figure><blockquote><p>行子查询(比较少用)</p></blockquote><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">SELECT * </span><br><span class="line">FROM  employees</span><br><span class="line">WHERE (employee_id, salary)=( # 一一对应比较筛选</span><br><span class="line">	SELECT MIN(employee_id), MAX(salary)</span><br><span class="line">    FROM employees</span><br><span class="line">)</span><br></pre></td></tr></table></figure><blockquote><p>在from后面(将子查询结果充当一张表，要求必须起别名)</p></blockquote><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">SELECT  ag_dep.*,g.`grade_level`</span><br><span class="line">FROM (</span><br><span class="line">	SELECT AVG(salary) ag,department_id</span><br><span class="line">	FROM employees</span><br><span class="line">	GROUP BY department_id</span><br><span class="line">) ag_dep</span><br><span class="line">INNER JOIN job_grades g</span><br><span class="line">ON ag_dep.ag BETWEEN lowest_sal AND highest_sal;</span><br></pre></td></tr></table></figure><p>在 exists 后使用方法同理</p><h3 id="7、分页查询"><a href="#7、分页查询" class="headerlink" title="7、分页查询"></a>7、分页查询</h3><p>语法:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">select 字段|表达式,...</span><br><span class="line">from 表</span><br><span class="line">【where 条件】</span><br><span class="line">【group by 分组字段】</span><br><span class="line">【having 条件】</span><br><span class="line">【order by 排序的字段】</span><br><span class="line">limit 【起始的条目索引】条目数;</span><br></pre></td></tr></table></figure><p>说明:</p><blockquote><p>1.起始条目索引从0开始<br>2.limit子句放在查询语句的最后<br>3.公式：select <em>from 表 limit （page-1）</em>sizePerPage,sizePerPage<br>假如:<br>每页显示条目数sizePerPage<br>要显示的页数 page</p></blockquote><h3 id="8、联合查询"><a href="#8、联合查询" class="headerlink" title="8、联合查询"></a>8、联合查询</h3><p>语法：</p><blockquote><p>select 字段|常量|表达式|函数 【from 表】 【where 条件】 union 【all】<br>select 字段|常量|表达式|函数 【from 表】 【where 条件】 union 【all】<br>select 字段|常量|表达式|函数 【from 表】 【where 条件】 union 【all】<br>…..<br>select 字段|常量|表达式|函数 【from 表】 【where 条件】</p></blockquote><p>说明：</p><blockquote><p>1、多条查询语句的<strong>查询的列数必须是一致的</strong><br>2、多条查询语句的查询的列的类型几乎相同<br>3、union代表去重，union all代表不去重</p></blockquote><h2 id="三、DDL-Data-Manipulation-Language"><a href="#三、DDL-Data-Manipulation-Language" class="headerlink" title="三、DDL(Data Manipulation Language)"></a>三、DDL(Data Manipulation Language)</h2><h3 id="1、插入"><a href="#1、插入" class="headerlink" title="1、插入"></a>1、插入</h3><p>语法：<br></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"># 方式一：支持插入多行，支持子查询</span><br><span class="line"># insert into table (selct * from table2 where ......)</span><br><span class="line">insert into 表名(字段名，...)</span><br><span class="line">	values(值1，...)，(值2，...);</span><br><span class="line"># 方式2：不支持多行</span><br><span class="line">insert into 表名 set 列名=值，列名2=值2;</span><br></pre></td></tr></table></figure><p></p><p>特点：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">1、字段类型和值类型一致或兼容，而且一一对应</span><br><span class="line">2、可以为空的字段，可以不用插入值，或用null填充</span><br><span class="line">3、不可以为空的字段，必须插入值</span><br><span class="line">4、字段个数和值的个数必须一致</span><br><span class="line">5、字段可以省略，但默认所有字段，并且顺序和表中的存储顺序一致</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">#方式一：（与方式二效果一致）</span><br><span class="line">INSERT INTO my_employees</span><br><span class="line">VALUES(1,&apos;patel&apos;,&apos;Ralph&apos;,&apos;Rpatel&apos;,895),</span><br><span class="line">(2,&apos;Dancs&apos;,&apos;Betty&apos;,&apos;Bdancs&apos;,860),</span><br><span class="line">(3,&apos;Biri&apos;,&apos;Ben&apos;,&apos;Bbiri&apos;,1100),</span><br><span class="line">(4,&apos;Newman&apos;,&apos;Chad&apos;,&apos;Cnewman&apos;,750),</span><br><span class="line">(5,&apos;Ropeburn&apos;,&apos;Audrey&apos;,&apos;Aropebur&apos;,1550);</span><br><span class="line"> </span><br><span class="line">#方式二：</span><br><span class="line">INSERT INTO my_employees</span><br><span class="line">SELECT 1,&apos;patel&apos;,&apos;Ralph&apos;,&apos;Rpatel&apos;,895 UNION</span><br><span class="line">SELECT 2,&apos;Dancs&apos;,&apos;Betty&apos;,&apos;Bdancs&apos;,860 UNION</span><br><span class="line">SELECT 3,&apos;Biri&apos;,&apos;Ben&apos;,&apos;Bbiri&apos;,1100 UNION</span><br><span class="line">SELECT 4,&apos;Newman&apos;,&apos;Chad&apos;,&apos;Cnewman&apos;,750 UNION</span><br><span class="line">SELECT 5,&apos;Ropeburn&apos;,&apos;Audrey&apos;,&apos;Aropebur&apos;,1550;</span><br></pre></td></tr></table></figure><h3 id="2、修改"><a href="#2、修改" class="headerlink" title="2、修改"></a>2、修改</h3><p>修改单表语法：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">update 表名 set 字段=新值,字段=新值</span><br><span class="line">【where 条件】</span><br></pre></td></tr></table></figure><p>修改多表语法：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">update 表1 别名1,表2 别名2</span><br><span class="line">set 字段=新值，字段=新值,......</span><br><span class="line">where 连接条件</span><br><span class="line">and 筛选条件</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">update boys bo inner join beauty b on bo.id = b.boyfriend_id </span><br><span class="line">set b.phone=&quot;1245555555&quot; where bo.boy_name = &quot;Mike&quot;</span><br></pre></td></tr></table></figure><h3 id="3、删除"><a href="#3、删除" class="headerlink" title="3、删除"></a>3、删除</h3><p>方式1：delete语句</p><p>单表的删除： ★<br>delete from 表名 【where 筛选条件】</p><p>多表的删除：<br>delete 别名1，别名2<br>from 表1 别名1，表2 别名2<br>where 连接条件<br>and 筛选条件;</p><p>方式2：truncate语句</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">truncate table 表名</span><br></pre></td></tr></table></figure><p>两种方式的区别【面试题】</p><blockquote><p>1.truncate不能加where条件，而delete可以加where条件<br>2.truncate的效率高一丢丢<br>3.<strong>truncate 删除带自增长的列的表后，如果再插入数据，数据从1开始</strong><br>delete 删除带自增长列的表后，如果再插入数据，数据从上一次的断点处开始<br>4.truncate删除不能回滚，delete删除可以回滚<br>5.truncate删除没有返回值，delete有（删除了多少行）</p></blockquote><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"># sql 92</span><br><span class="line">delete bo,b where bo.id = b.boyfriend_id and bo.boy_name = &quot;Mike&quot; </span><br><span class="line"># sql 99</span><br><span class="line">delete boys bo inner join beauty b on bo.id = b.boyfriend_id where bo.boy_name = &quot;Mike&quot;</span><br></pre></td></tr></table></figure><h3 id="4、库与表管理"><a href="#4、库与表管理" class="headerlink" title="4、库与表管理"></a>4、库与表管理</h3><ul><li>创建：create</li><li>修改：alter</li><li>删除：drop</li></ul><h4 id="（1）库管理"><a href="#（1）库管理" class="headerlink" title="（1）库管理"></a>（1）库管理</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"># 不存在则创建, </span><br><span class="line"># 默认字符集 utf8, 使用utf8编码进行排序，ci为case insensitive 忽略大小写，utf8_general_cs区分大小写（不一定支持）</span><br><span class="line">CREATE DATABASE IF NOT EXISTS database_name DEFAULT CHARACTER SET utf8 COLLATE utf8_general_ci</span><br><span class="line"># 库修改（一般很少修改）</span><br><span class="line">RENAME DATABASE database_name to new_name # 已弃用，不支持修改，也最好不修改</span><br><span class="line">ALTER DATABASE database_name CHARACTER SET utf8</span><br><span class="line"># 库删除</span><br><span class="line">DROP DATABASE IF EXISTS database_name</span><br></pre></td></tr></table></figure><h4 id="（2）表管理"><a href="#（2）表管理" class="headerlink" title="（2）表管理"></a>（2）表管理</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">/*</span><br><span class="line">CREARE TABLE table_name(</span><br><span class="line">	col1_name col1_type(col1_length),</span><br><span class="line">    col2_name col2_type(col2_length),</span><br><span class="line">    .......</span><br><span class="line">)</span><br><span class="line">*/</span><br><span class="line">DROP TABLE IF EXISTS talbe_name;</span><br><span class="line">CREATE TABLE IF NOT EXISTS table_name (</span><br><span class="line">	`id` int(11) not null AUTO_INCREMENT,</span><br><span class="line">    `name` varchar(50) not null comment &quot;姓名&quot;,</span><br><span class="line">    `age` int(4) not null comment &quot;年龄&quot;,</span><br><span class="line">    `birth` varchar(20) not null comment &quot;出生&quot;,</span><br><span class="line">    ......</span><br><span class="line">    PRIMARY KEY(`id`) using BTREE</span><br><span class="line">)</span><br><span class="line">ENGINE=INNODB </span><br><span class="line">AUTO_INCREMENT = 1</span><br><span class="line">CHARACTER SET=utf8 </span><br><span class="line">COLLATE utf8_general_ci</span><br><span class="line">ROW_FORMAT=Dynamic</span><br><span class="line"></span><br><span class="line"># 表修改</span><br><span class="line">ALTER TABLE table_name RENAME TO new_table_name; # 修改表名</span><br><span class="line">DROP TABLE IF EXISTS talbe_name # 删除表</span><br><span class="line">ALTER TABLE table_name ADD COLUMN death varchar(20); # 增加列</span><br><span class="line">ALTER TABLE table_name CHANGE COLUMN birth,birth_date varchar(30); # 修改列名</span><br><span class="line">ALTER TABLE table_name MODIFY COLUMN birth_date TIMESTAMP; # 修改列类型或约束</span><br><span class="line">ALTER TABLE table_name DROP COLUMN death;  # 删除列</span><br><span class="line"># 表复制</span><br><span class="line">CREATE TABLE table_name LIKE table2copy;# 复制表结构</span><br><span class="line">CREATE TABLE table_name AS SELECT col1,col2.... FROM table2copy where 1=2; # 复制表部分结构</span><br><span class="line">CREATE TABLE table_name AS SELECT * FROM table2copy WHERE .....;# 复制表结构和数据(可指定行列)</span><br></pre></td></tr></table></figure><h4 id="（3）常见数据类型"><a href="#（3）常见数据类型" class="headerlink" title="（3）常见数据类型"></a>（3）常见数据类型</h4><blockquote><p>数值选择类型：选择的类型越简单越好，能保存数值的类型越小越好</p></blockquote><ul><li><p>数值型</p><ul><li><p>整数</p><ul><li>Tinyint（1 byte）：无符号0~255，有符号 -128~127</li><li>Smallint（2 byte）：无符号 0~65535,有符号-32768~32767</li><li>Mediumint（13byte）</li><li>Int, integer（4 byte）</li><li>Bigint（8 byte）<blockquote><ul><li>如果不设置，默认为有符号数，设置无符号数，添加unsigned关键字</li><li>如果插入数值超出范围，会报 out of range 异常，并插入临界值</li><li>如果不设置字段长度，会设置默认长度，尝试代表显示的最大宽度</li></ul></blockquote></li></ul></li><li><p>小数</p></li></ul></li></ul><blockquote><p>M:整数部分+小数部分 总位数<br>D:小数部分 位数<br>如果超过范围，则插入临界值<br>M,D可以省略，如果是Decima， M默认为10，D默认为0</p></blockquote><ul><li><ul><li>定点数<blockquote><ul><li>DEC(M,D)： M+2字节，DECIMAL的简写，</li><li>DECIMAL(M,D)：M+2字节，通过D控制精度</li></ul></blockquote></li></ul></li></ul><ul><li><ul><li>浮点数</li></ul></li></ul><blockquote><ul><li>float(M,D)：（4 byte）</li><li>double(M,D)：（8byte）</li></ul></blockquote><ul><li>字符型<ul><li>较短文本：char varchar</li><li>较长文本：text blob(较长的二进制文本)</li><li>Enum : 枚举类型，用于限定为指定值，如性别只能 “男” 或 “女”，若不在范围内，则会插入失败</li><li>Bit</li><li>binary varbinary : 较短的二进制</li><li>Set ：集合类，和Enum类似<blockquote><p>M代表字符数</p><p>char(M) : M为0~255之间，M默认为1<br>varchar(M) : M为0~65535之间，M不可省略</p><p>区别：<br>char 固定长度字符，效率较高，空间消耗相对大，多用于存储变化相对小的内容<br>varchar 可变长度字符，效率较低，空间消耗相对小，多用于存储内容变化大的内容</p></blockquote></li></ul></li></ul><ul><li>日期型</li></ul><blockquote><p><img src="/2018/08/20/MySQL学习笔记/1562751140613.png" alt="1562751140613"></p><div class="table-container"><table><thead><tr><th style="text-align:center"></th><th style="text-align:center">字节</th><th style="text-align:center">范围</th><th style="text-align:center">时区影响</th></tr></thead><tbody><tr><td style="text-align:center">datetime</td><td style="text-align:center">8</td><td style="text-align:center">1000~9999年</td><td style="text-align:center">不受</td></tr><tr><td style="text-align:center">timestamp</td><td style="text-align:center">4</td><td style="text-align:center">1970~2038年</td><td style="text-align:center">受</td></tr></tbody></table></div></blockquote><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">CREATE table IF NOT EXISTS table_name(</span><br><span class="line">	t1 INT, # 有符号数</span><br><span class="line">	t2 INT UNSIGNED # 无符号数</span><br><span class="line">) </span><br><span class="line">CREATE table IF NOT EXISTS table_name(</span><br><span class="line">	t1 INT ZEROFILL, # 有符号数,0填充，将省略的0显示出来，若0填充，默认为有符号数</span><br><span class="line">	t2 INT UNSIGNED # 无符号数</span><br><span class="line">) </span><br><span class="line">CREATE table IF NOT EXISTS table_name(</span><br><span class="line">	sex ENUM(&quot;男&quot;, &quot;女&quot;), # sex 值只能为 男 或 女</span><br><span class="line">) </span><br><span class="line">CREATE table IF NOT EXISTS table_name(</span><br><span class="line">	group ENUM(&quot;a&quot;, &quot;b&quot;, &quot;c&quot;, &quot;d&quot;), # 插入时，可以插入多个，如 insert into table_name values(&quot;a,b,c&quot;)</span><br><span class="line">)</span><br></pre></td></tr></table></figure><h3 id="5、常见约束"><a href="#5、常见约束" class="headerlink" title="5、常见约束"></a>5、常见约束</h3><blockquote><p>用于限制表中的数据，以保证数据的准确和可靠性，一般有列级和表级约束</p><ul><li>列级约束：六种约束都支持，但是外键约束无效果</li><li>表级约束：除了非空和默认，其他都支持</li></ul><p>约束种类(6大约束)：</p><ul><li>NOT NULL: 非空</li><li>DEFAULT: 默认值</li><li>PRIMARY KEY: 主键，值在该字段中唯一且非空</li><li>UNIQUE：唯一，用于保证该值在字段中唯一，可以为空；如：座位号</li><li>CHECK : 检查约束(mysql 不支持)</li><li>FOREIGN KEY ： 外键，用于限制两个表的关系，用于保证该字段的值必须来自主表关联列的值，在从表添加外键约束，用于应用主表中某列的值，如学生的专业编号，员工的部门编号等；一般在<strong>创建或修改表</strong>时建立外键</li></ul><p>列级约束类型：直接在字段名和类型后面追加约束类型即可，只支持 默认、非空、主键、唯一四种约束<br>表级约束：在字段定义结束后，添加 [constraint 约束名] 约束类型(字段名)</p><p><img src="/2018/08/20/MySQL学习笔记/1562769406463.png" alt="1562769406463">constraint pk primary key(id)<br>constraint uq unique(seat)<br>constraint ck check(gender = ‘男’ or gender = ‘女’)<br>constraint fk_stuinfo_major foreign key(majorid) references major(id)</p></blockquote><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">CREATE TABLE table_name(</span><br><span class="line">	col_name col_type  col_restriction</span><br><span class="line">)</span><br></pre></td></tr></table></figure><p>修改表时添加约束，在原修改表基础后面添加 约束字段即可</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"># 修改列级约束，可以起到 添加、删除、修改效果</span><br><span class="line">alter table 表名 modify column 字段名 字段类型 新约束</span><br><span class="line"># 删除 主键</span><br><span class="line">alter table 表名 drop primary key</span><br><span class="line"># 删除唯一</span><br><span class="line">alter table 表名 drop index index_name</span><br><span class="line"># 删除外键</span><br><span class="line">alter table 表名 drop foreign key key_name</span><br><span class="line"># 添加表级约束</span><br><span class="line">alter table 表名 add [constraint 约束名] 约束类型(字段名) [外键的引用]</span><br></pre></td></tr></table></figure><h3 id="6、标识列"><a href="#6、标识列" class="headerlink" title="6、标识列"></a>6、标识列</h3><p>建表时，在列后添加 AUTO_INCREMENT ,可以通过语句指定自增长的步长</p><p>注：</p><ul><li>一个表中只能有一个字段是自增长</li><li>标识列的类型：只能是数值类型</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SET auto_increment_increment = 3 # 设置步长</span><br></pre></td></tr></table></figure><h2 id="四、TCL-Transaction-Control-Language"><a href="#四、TCL-Transaction-Control-Language" class="headerlink" title="四、TCL(Transaction Control Language)"></a>四、TCL(Transaction Control Language)</h2><h3 id="1-事务"><a href="#1-事务" class="headerlink" title="1. 事务"></a>1. 事务</h3><blockquote><p>一个或一组sql语句组成的一个执行单元，这个执行要么全部执行，要么全不执行</p></blockquote><h4 id="1-事务特性-ACID"><a href="#1-事务特性-ACID" class="headerlink" title="(1) 事务特性(ACID)"></a>(1) 事务特性(ACID)</h4><ul><li>原子性（Atomicity）<br>原子性是指事务是一个不可分割的工作单位，事务中的操作要么都发生，要么都不发生。</li><li>一致性（Consistency）<br>事务前后数据的完整性必须保持一致。</li><li>隔离性（Isolation）<br>事务的隔离性是多个用户并发访问数据库时，数据库为每一个用户开启的事务，不能被其他事务的操作数据所干扰，多个并发事务之间要相互隔离。</li><li>持久性（Durability）<br>持久性是指一个事务一旦被提交，它对数据库中数据的改变就是永久性的，接下来即使数据库发生故障也不应该对其有任何影响</li></ul><h4 id="2-事务的创建"><a href="#2-事务的创建" class="headerlink" title="(2) 事务的创建"></a>(2) 事务的创建</h4><blockquote><p>隐式事务：事务没有明显的开启和结束的标记，如 insert update delete 语句<br>显式事务：事务具有明显的开启和结束的标记，必须先设置自动提交功能为禁用</p></blockquote><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"># 设置自动提交为0，</span><br><span class="line">SET AUTOCOMMIT = 0;</span><br><span class="line">START TRANSACTION; # 这一句可选</span><br><span class="line">-- 事务语句 --</span><br><span class="line">-- 事务语句 --</span><br><span class="line">SAVEPOINT point_name # 设置保存点， 配合 ROLLBACK TO 使用</span><br><span class="line">-- 事务语句 --</span><br><span class="line">.......</span><br><span class="line"># 提交或回滚，二选一</span><br><span class="line">COMMIT # 提交事务</span><br><span class="line">ROLLBACK # 回滚所有事务</span><br><span class="line">ROLLBACK TO point_name # 回滚到指定的保存点</span><br></pre></td></tr></table></figure><h4 id="3-并发一致性问题"><a href="#3-并发一致性问题" class="headerlink" title="(3) 并发一致性问题"></a>(3) 并发一致性问题</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"># 包含四种级别：READ-UNCOMMITTED, READ-COMMITTED, REPEATABLE-READ, SERIALIZABLE</span><br><span class="line">set session transaction isolation level serializable</span><br></pre></td></tr></table></figure><ul><li>丢失修改</li><li>读脏数据</li><li>不可重复读</li><li>幻影读</li></ul><div class="table-container"><table><thead><tr><th style="text-align:center">隔离级别</th><th style="text-align:center">脏读</th><th style="text-align:center">不可重复读</th><th style="text-align:center">幻影读</th><th style="text-align:center">加锁读</th></tr></thead><tbody><tr><td style="text-align:center">未提交读</td><td style="text-align:center">√</td><td style="text-align:center">√</td><td style="text-align:center">√</td><td style="text-align:center">×</td></tr><tr><td style="text-align:center">提交读</td><td style="text-align:center">×</td><td style="text-align:center">√</td><td style="text-align:center">√</td><td style="text-align:center">×</td></tr><tr><td style="text-align:center">可重复读</td><td style="text-align:center">×</td><td style="text-align:center">×</td><td style="text-align:center">√</td><td style="text-align:center">×</td></tr><tr><td style="text-align:center">可串行化</td><td style="text-align:center">×</td><td style="text-align:center">×</td><td style="text-align:center">×</td><td style="text-align:center">√</td></tr></tbody></table></div><h4 id="delete-和-truncate-在事务中的区别"><a href="#delete-和-truncate-在事务中的区别" class="headerlink" title="delete 和 truncate 在事务中的区别"></a>delete 和 truncate 在事务中的区别</h4><blockquote><p>delete 支持回滚， truncate 不支持</p></blockquote><h2 id="五、-视图"><a href="#五、-视图" class="headerlink" title="五、 视图"></a>五、 视图</h2><p>虚拟表，和普通表一样使用。mysql 5.1 版本出现的新特性，是通过表动态生成的数据。<br>注意：视图只保存 sql 逻辑，不保存查询结果，虚拟表中的数据都是根据视图定义查询动态生成的。</p><h4 id="视图创建与修改"><a href="#视图创建与修改" class="headerlink" title="视图创建与修改"></a>视图创建与修改</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"># 视图创建</span><br><span class="line">CREATE VIEW view_name AS </span><br><span class="line">-- 查询语句 -- # 查询语句中 可以包含已有视图</span><br><span class="line"># 使用视图</span><br><span class="line">SELECT * FROM view_name WHERE .......</span><br><span class="line"># 视图修改, 方式一</span><br><span class="line">CREATE OR REPLACE VIEW view_name AS</span><br><span class="line">-- 查询语句</span><br><span class="line"># 视图修改， 方式二</span><br><span class="line">ALTER VIEW view_name AS </span><br><span class="line">-- 查询语句</span><br><span class="line"># 查看视图</span><br><span class="line">DESC view_name;</span><br><span class="line">SHOW CREATE VIEW view_name;</span><br></pre></td></tr></table></figure><h4 id="视图更新"><a href="#视图更新" class="headerlink" title="视图更新"></a>视图更新</h4><blockquote><p>可以实现数据的插入、修改、删除，会对原始表进行修改；语法和普通SQL语句一致。</p></blockquote><p>具备以下类型的视图是不能更新(有些只是 插入、修改、删除其中一项不允许)</p><blockquote><ul><li>包含以下关键字的sql语句：聚合函数(sum、min、max、count)、distinct、group by 、having、union或者uinon all<ul><li>常量视图</li><li>select 中包含子查询</li><li>join</li><li>from一个不可更新的视图</li><li>where字句的子查询引用了from字句中的表</li></ul></li></ul></blockquote><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">UPDATE view_name SET .... WHERE ...</span><br><span class="line">DELETE view_name WHERE ....</span><br><span class="line">INSERT view_name WHERE .... # 原表不涉及的字段，用默认值填充</span><br></pre></td></tr></table></figure><p>视图好处：</p><blockquote><ul><li>重用 sql 语句</li><li>简化复杂的 sql 操作， 不必知道具体查询细节</li><li>保护数据，提高安全性</li></ul></blockquote><h2 id="六、变量"><a href="#六、变量" class="headerlink" title="六、变量"></a>六、变量</h2><p>变量种类：</p><ul><li>系统变量<ul><li>全局变量</li><li>会话变量</li></ul></li><li>自定义变量<ul><li>用户变量</li><li>局部变量</li></ul></li></ul><h3 id="系统变量"><a href="#系统变量" class="headerlink" title="系统变量"></a>系统变量</h3><blockquote><p>变量由系统提供，属于服务器层面。全局变量与会话变量的区别在于，会话变量仅仅针对当前会话(连接)有效</p><p>如果是全局变量，则需要添加 global关键词，如果是会话级别，则需要加 session 关键字，系统默认为 session，可不写</p></blockquote><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"># 查看所有的系统变量</span><br><span class="line">show global | session variables;</span><br><span class="line"># 查看满足条件的部分系统变量</span><br><span class="line">show global | session variables like &apos;%query_content%&apos;</span><br><span class="line"># 查看指定系统变量名，注意，在变量名前需要加一个点</span><br><span class="line">select @@global | @@session .system_variable_name</span><br><span class="line"># 为某个系统变量赋值</span><br><span class="line">set global | session system_variable_name = new_value</span><br><span class="line">set @@global | @@session .system_variable_name= new _value # 注意，在变量名前需要加一个点</span><br></pre></td></tr></table></figure><h3 id="自定义变量"><a href="#自定义变量" class="headerlink" title="自定义变量"></a>自定义变量</h3><blockquote><p>针对当前会话(连接有效)，与会话变量作用域相同<br>赋值操作符为 “= ”或 “ := ”</p></blockquote><p>用户变量(可存放在任何地方)</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"># 声明变量并初始化</span><br><span class="line">set @var_name = _value</span><br><span class="line">set @var_name := _value</span><br><span class="line">select @var_name := _value</span><br><span class="line"># 变量赋值</span><br><span class="line">select col_name into var_name from table_name # 得出的结果必须只有一个</span><br></pre></td></tr></table></figure><p>局部变量</p><blockquote><p>仅仅在定义的 begin, end 中有效<br>只能应用在 begin end 中的第一个语句</p></blockquote><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"># 变量声明</span><br><span class="line">declare var_name var_type;</span><br><span class="line">declare var_name var_type default var_value;</span><br><span class="line"># 赋值</span><br><span class="line">set @var_name = _value</span><br><span class="line">set @var_name := _value</span><br><span class="line">select @var_name := _value</span><br><span class="line">select col_name into var_name from table_name # 得出的结果必须只有一个</span><br><span class="line"># 使用  获取值</span><br><span class="line">select var_name</span><br></pre></td></tr></table></figure><h2 id="七、存储过程和函数"><a href="#七、存储过程和函数" class="headerlink" title="七、存储过程和函数"></a>七、存储过程和函数</h2><h3 id="存储过程"><a href="#存储过程" class="headerlink" title="存储过程"></a>存储过程</h3><blockquote><p>预先编译好的SQL语句的集合，类似批处理语句</p><ul><li>提高代码重用性</li><li>简化操作</li><li>减少了编译次数并减少了和数据库服务器的链接次数，提高了效率</li></ul></blockquote><h4 id="创建语法"><a href="#创建语法" class="headerlink" title="创建语法"></a>创建语法</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">create procedure prd_name(param_list)</span><br><span class="line">begin</span><br><span class="line">	prd_body(一组合法的SQL语句)</span><br><span class="line">end</span><br><span class="line"># 举例</span><br><span class="line">DELIMITER $</span><br><span class="line">CREATE  PROCEDURE test3(IN in_name varchar(20)) BEGIN</span><br><span class="line">INSERT INTO liangtest VALUES( NULL, in_name, &quot;3&quot; );</span><br><span class="line">END $</span><br><span class="line">CALL test3(&quot;liang3&quot;);# 调用</span><br></pre></td></tr></table></figure><p>参数模式：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">/*</span><br><span class="line">IN : 使用IN类型来传递信息，存储过程内部可以对参数的值进行修改，但是修改后的值调用者不可见。</span><br><span class="line">OUT : 使用OUT类型来传递信息，在存储过程内部，该值的默认值为NULL，无论调用者是否传值给存储过程。</span><br><span class="line">INOUT : 使用IN类型来传递信息，存储过程内部可以对参数的值进行修改，并将最终值返回给调用者。</span><br><span class="line">*/</span><br></pre></td></tr></table></figure><p>注意事项：</p><blockquote><ol><li>如果存储过程体仅仅只有一句话，则 begin 和 end 可以胜率</li><li>存储过程体中的每条 SQL 语句结尾要求必须加分号</li><li>存储过程的结尾可以使用 DELIMITER 重新设置</li></ol></blockquote><p>调用</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">CALL prd_name(param_list)</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"># 举例 IN</span><br><span class="line">DELIMITER $</span><br><span class="line">CREATE  PROCEDURE test2(IN in_name varchar(20)) </span><br><span class="line">BEGIN</span><br><span class="line">	DECLARE age INT DEFAULT 0;</span><br><span class="line">	SELECT age INTO age</span><br><span class="line">	FROM liangtest</span><br><span class="line">	WHERE `name` = in_name;</span><br><span class="line">    </span><br><span class="line">    SELECT IF(age&gt;20, &apos;成功&apos;, &apos;失败&apos;); # 使用，打印结果</span><br><span class="line">END $</span><br><span class="line">CALL test3(&quot;liang3&quot;);# 调用</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"># 举例 OUT</span><br><span class="line">DELIMITER $</span><br><span class="line">CREATE  PROCEDURE test4(IN in_name varchar(20), OUT age INT(4)) // 同理可以有多个out</span><br><span class="line">BEGIN </span><br><span class="line">	SELECT age INTO age</span><br><span class="line">	FROM liangtest</span><br><span class="line">	WHERE `name` = in_name;</span><br><span class="line">END $</span><br><span class="line">-- ----------------</span><br><span class="line">SET @age$</span><br><span class="line">CALL test3(&quot;liang3&quot;, @age)$# 调用</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"># 举例 INOUT</span><br><span class="line">DELIMITER $</span><br><span class="line">CREATE  PROCEDURE test4(INOUT a INT, INOUT B INT) </span><br><span class="line">BEGIN // 同理可以有多个out</span><br><span class="line">	SET a=a*2; </span><br><span class="line">	SET b=b*2;</span><br><span class="line">END $</span><br><span class="line">-- ----------------</span><br><span class="line">SET @m=10$</span><br><span class="line">set @n=20$</span><br><span class="line">CALL test3(@m,@n)$# 调用</span><br><span class="line">select @m, @n;</span><br></pre></td></tr></table></figure><h4 id="删除存储进程"><a href="#删除存储进程" class="headerlink" title="删除存储进程"></a>删除存储进程</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">DROP PROCEDURE prd_name1, prd_nam2;</span><br></pre></td></tr></table></figure><h4 id="查看存储过程信息"><a href="#查看存储过程信息" class="headerlink" title="查看存储过程信息"></a>查看存储过程信息</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SHOW CREATE PROCEDURE prd_name;</span><br></pre></td></tr></table></figure><h3 id="函数"><a href="#函数" class="headerlink" title="函数"></a>函数</h3><blockquote><p>函数和存储过程区别：函数有且仅有一个返回</p></blockquote><h4 id="创建函数"><a href="#创建函数" class="headerlink" title="创建函数"></a>创建函数</h4><blockquote><p>参数列表包含两部分：参数名，参数类型<br>函数体：</p><ul><li>一定要要有 return 语句，如果没有，不会报错，但没有意义，不建议</li><li>函数体中仅有一个语句时，可以省略 BEGIN, END</li><li>使用 delimiter 语句设置结束标记</li></ul></blockquote><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">CREATE FUNCTION func_name(param_list) RETURNS return_type</span><br><span class="line">BEGIN</span><br><span class="line">	FUNC_BODY;</span><br><span class="line">END</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"># 举例</span><br><span class="line">DELIMITER $;</span><br><span class="line">CREATE FUNCTION query_count() RETURNS INT</span><br><span class="line">BEGIN</span><br><span class="line">	DECLARE cnt INT DEFAULT 0;</span><br><span class="line">	SELECT count(*) INTO cnt </span><br><span class="line">	FROM liangtest;</span><br><span class="line">	RETURN cnt;</span><br><span class="line">END $</span><br><span class="line"># 调用</span><br><span class="line">SELECT query_count() $</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"># 举例</span><br><span class="line">DELIMITER $;</span><br><span class="line">CREATE FUNCTION query_count(in_name VARCHAR(20)) RETURNS INT</span><br><span class="line">BEGIN</span><br><span class="line">	SET @age=0;</span><br><span class="line">	SELECT age INTO @age</span><br><span class="line">	FROM liangtest</span><br><span class="line">	WHERE `name` = in_name;</span><br><span class="line">	RETURN age</span><br><span class="line">END $</span><br><span class="line"># 调用</span><br><span class="line">SELECT query_count(&quot;liang3&quot;) $</span><br></pre></td></tr></table></figure><h4 id="查看函数"><a href="#查看函数" class="headerlink" title="查看函数"></a>查看函数</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SHOW CREATE FUNCTION func_name; // 通过type字段区分 函数 和 存储过程</span><br></pre></td></tr></table></figure><h3 id="流程控制结构"><a href="#流程控制结构" class="headerlink" title="流程控制结构"></a>流程控制结构</h3><ul><li>顺序结构</li><li>分支结构</li><li>循环结构</li></ul><h4 id="分支结构"><a href="#分支结构" class="headerlink" title="分支结构"></a>分支结构</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">/*</span><br><span class="line">if函数</span><br><span class="line">	语法：if(条件，值1，值2)</span><br><span class="line">	特点：可以用在任何位置</span><br><span class="line">case语句</span><br><span class="line">特点：可以用在任何位置</span><br><span class="line">*/</span><br><span class="line">情况一：类似于switch</span><br><span class="line">case 表达式</span><br><span class="line">when 值1 then 结果1或语句1(如果是语句，需要加分号) </span><br><span class="line">when 值2 then 结果2或语句2(如果是语句，需要加分号)</span><br><span class="line">...</span><br><span class="line">else 结果n或语句n(如果是语句，需要加分号)</span><br><span class="line">end 【case】（如果是放在begin end中需要加上case，如果放在select后面不需要）</span><br><span class="line"></span><br><span class="line">情况二：类似于多重if</span><br><span class="line">case </span><br><span class="line">when 条件1 then 结果1或语句1(如果是语句，需要加分号) </span><br><span class="line">when 条件2 then 结果2或语句2(如果是语句，需要加分号)</span><br><span class="line">...</span><br><span class="line">else 结果n或语句n(如果是语句，需要加分号)</span><br><span class="line">end 【case】（如果是放在begin end中需要加上case，如果放在select后面不需要）</span><br><span class="line">/*</span><br><span class="line">if elseif 语句</span><br><span class="line">特点：</span><br><span class="line">	只能用在begin end中！！！！！！！！！！！！！！！</span><br><span class="line">*/</span><br><span class="line">if 情况1 then 语句1;</span><br><span class="line">elseif 情况2 then 语句2;</span><br><span class="line">...</span><br><span class="line">else 语句n;</span><br><span class="line">end if;</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">/*=================   这些都可以放在函数体中    =================*/</span><br><span class="line"># IF(expr1,expr2,expr3) 类似三元运算符</span><br><span class="line">select `name` IF(salary IS NULL, &apos;值异常&apos;, &apos;值正常&apos;)</span><br><span class="line"># case 和Java中的switch...case...效用一致，但是只用用于等值判断</span><br><span class="line">SELECT `姓名`,`数学`,</span><br><span class="line">CASE `数学`</span><br><span class="line">	WHEN 100 THEN &quot;满分&quot;</span><br><span class="line">	WHEN 90 THEN &quot;合格&quot;</span><br><span class="line">	ELSE &quot;其他&quot;</span><br><span class="line">END AS 是否及格</span><br><span class="line">FROM `month_test_1`；</span><br><span class="line"># 类似多重if</span><br><span class="line">SELECT `姓名`,`语文`,</span><br><span class="line">CASE </span><br><span class="line">	WHEN `语文`&lt;60.0 THEN &quot;不及格&quot;</span><br><span class="line">	WHEN `语文`&gt;=60.0 and `语文`&lt; 70 THEN &quot;合格&quot;</span><br><span class="line">	WHEN `语文`&gt;=70.0 and `语文`&lt; 80 THEN &quot;良好&quot;</span><br><span class="line">	ELSE &quot;优秀&quot;</span><br><span class="line">END AS 等级</span><br><span class="line">FROM `month_test_1`；</span><br></pre></td></tr></table></figure><h4 id="循环"><a href="#循环" class="headerlink" title="循环"></a>循环</h4><blockquote><p>主要有 while loop repeat</p><p>只能放在BEGIN END里面</p><p>如果要搭配leave跳转语句，需要使用标签，否则可以不用标签</p><p>leave类似于java中的break语句，跳出所在循环</p></blockquote><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"># WHILE</span><br><span class="line">[标签]: WHILE 循环条件  DO</span><br><span class="line">	循环体</span><br><span class="line">END WHILE [标签];</span><br><span class="line"></span><br><span class="line"># LOOP</span><br><span class="line"></span><br><span class="line">[标签]：LOOP</span><br><span class="line">	循环体</span><br><span class="line">END LOOP [标签];</span><br><span class="line"></span><br><span class="line"># REPEAT</span><br><span class="line">[标签]: REPEATE</span><br><span class="line">	循环体</span><br><span class="line">END REPEAT [标签];</span><br></pre></td></tr></table></figure><blockquote><p>leave 语句，相当于 break</p><p>iterate 语句， 相当于 continue</p></blockquote><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">TRUNCATE TABLE admin$</span><br><span class="line">DROP PROCEDURE test_while1$</span><br><span class="line">CREATE PROCEDURE test_while1(IN insertCount INT)</span><br><span class="line">BEGIN</span><br><span class="line">	DECLARE i INT DEFAULT 1;</span><br><span class="line">	a:WHILE i&lt;=insertCount DO</span><br><span class="line">		INSERT INTO admin(username,`password`) VALUES(CONCAT(&apos;xiaohua&apos;,i),&apos;0000&apos;);</span><br><span class="line">		IF i&gt;=20 THEN LEAVE a;</span><br><span class="line">		END IF;</span><br><span class="line">		SET i=i+1;</span><br><span class="line">	END WHILE a;</span><br><span class="line">END $</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">CALL test_while1(100)$</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">TRUNCATE TABLE admin$</span><br><span class="line">DROP PROCEDURE test_while1$</span><br><span class="line">CREATE PROCEDURE test_while1(IN insertCount INT)</span><br><span class="line">BEGIN</span><br><span class="line">	DECLARE i INT DEFAULT 0;</span><br><span class="line">	a:WHILE i&lt;=insertCount DO</span><br><span class="line">		SET i=i+1;</span><br><span class="line">		IF MOD(i,2)!=0 THEN ITERATE a;</span><br><span class="line">		END IF;</span><br><span class="line">		</span><br><span class="line">		INSERT INTO admin(username,`password`) VALUES(CONCAT(&apos;xiaohua&apos;,i),&apos;0000&apos;);</span><br><span class="line">		</span><br><span class="line">	END WHILE a;</span><br><span class="line">END $</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">CALL test_while1(100)$</span><br></pre></td></tr></table></figure></div><div><ul class="post-copyright"><li class="post-copyright-author"><strong>本文作者：</strong> Liang</li><li class="post-copyright-link"><strong>本文链接：</strong> <a href="https://pengshiliang.coding.me/2018/08/20/MySQL学习笔记/" title="MySQL 基础 学习笔记">https://pengshiliang.coding.me/2018/08/20/MySQL学习笔记/</a></li><li class="post-copyright-license"><strong>版权声明： </strong>本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/3.0/" rel="external nofollow" target="_blank">CC BY-NC-SA 3.0</a> 许可协议。转载请注明出处！</li></ul></div><footer class="post-footer"><div class="post-tags"><a href="/tags/MySQL/" rel="tag"># MySQL</a></div><div class="post-nav"><div class="post-nav-next post-nav-item"><a href="/2018/08/09/MySQL_loseConnection/" rel="next" title="连接池丢失MySQL连接"><i class="fa fa-chevron-left"></i> 连接池丢失MySQL连接</a></div><span class="post-nav-divider"></span><div class="post-nav-prev post-nav-item"><a href="/2018/09/02/advanced-MySQL/" rel="prev" title="MySQL 数据库原理">MySQL 数据库原理 <i class="fa fa-chevron-right"></i></a></div></div></footer></div></article><div class="post-spread"></div></div></div><div class="comments" id="comments"></div></div><div class="sidebar-toggle"><div class="sidebar-toggle-line-wrap"><span class="sidebar-toggle-line sidebar-toggle-line-first"></span> <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span> <span class="sidebar-toggle-line sidebar-toggle-line-last"></span></div></div><aside id="sidebar" class="sidebar"><div class="sidebar-inner"><ul class="sidebar-nav motion-element"><li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">文章目录</li><li class="sidebar-nav-overview" data-target="site-overview-wrap">站点概览</li></ul><section class="site-overview-wrap sidebar-panel"><div class="site-overview"><div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person"><img class="site-author-image" itemprop="image" src="/images/head-32x32.png" alt="Liang"><p class="site-author-name" itemprop="name">Liang</p><p class="site-description motion-element" itemprop="description">一个喜欢养花养草的扫地僧</p></div><nav class="site-state motion-element"><div class="site-state-item site-state-posts"><a href="/archives/"><span class="site-state-item-count">30</span> <span class="site-state-item-name">日志</span></a></div><div class="site-state-item site-state-categories"><a href="/categories/index.html"><span class="site-state-item-count">15</span> <span class="site-state-item-name">分类</span></a></div><div class="site-state-item site-state-tags"><a href="/tags/index.html"><span class="site-state-item-count">26</span> <span class="site-state-item-name">标签</span></a></div></nav><div class="links-of-author motion-element"><span class="links-of-author-item"><a href="https://github.com/liang-2018" target="_blank" title="GitHub"><i class="fa fa-fw fa-github"></i>GitHub</a> </span><span class="links-of-author-item"><a href="mailto:doubieheart@qq.com" target="_blank" title="E-Mail"><i class="fa fa-fw fa-envelope"></i>E-Mail</a></span></div></div></section><section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active"><div class="post-toc"><div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#一、相关基础"><span class="nav-text">一、相关基础</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1、相关概念"><span class="nav-text">1、相关概念</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2、安装、环境配置等-略"><span class="nav-text">2、安装、环境配置等(略)</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3、优点"><span class="nav-text">3、优点</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4、配置文件"><span class="nav-text">4、配置文件</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#5、连接"><span class="nav-text">5、连接</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#6、MySQL语法规范"><span class="nav-text">6、MySQL语法规范</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#7、常见命令"><span class="nav-text">7、常见命令</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#二、DQL-Data-Query-Language"><span class="nav-text">二、DQL(Data Query Language)</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1、基础查询、条件查询"><span class="nav-text">1、基础查询、条件查询</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2、排序查询"><span class="nav-text">2、排序查询</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3、常用函数"><span class="nav-text">3、常用函数</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#（1）字符函数"><span class="nav-text">（1）字符函数</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#（2）数学函数"><span class="nav-text">（2）数学函数</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#（3）日期函数"><span class="nav-text">（3）日期函数</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#（4）其他函数"><span class="nav-text">（4）其他函数</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#（5）流程控制函数"><span class="nav-text">（5）流程控制函数</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#（6）分组函数"><span class="nav-text">（6）分组函数</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4、分组查询"><span class="nav-text">4、分组查询</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#5、连接查询"><span class="nav-text">5、连接查询</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#6、子查询"><span class="nav-text">6、子查询</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#7、分页查询"><span class="nav-text">7、分页查询</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#8、联合查询"><span class="nav-text">8、联合查询</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#三、DDL-Data-Manipulation-Language"><span class="nav-text">三、DDL(Data Manipulation Language)</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1、插入"><span class="nav-text">1、插入</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2、修改"><span class="nav-text">2、修改</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3、删除"><span class="nav-text">3、删除</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4、库与表管理"><span class="nav-text">4、库与表管理</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#（1）库管理"><span class="nav-text">（1）库管理</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#（2）表管理"><span class="nav-text">（2）表管理</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#（3）常见数据类型"><span class="nav-text">（3）常见数据类型</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#5、常见约束"><span class="nav-text">5、常见约束</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#6、标识列"><span class="nav-text">6、标识列</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#四、TCL-Transaction-Control-Language"><span class="nav-text">四、TCL(Transaction Control Language)</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1-事务"><span class="nav-text">1. 事务</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#1-事务特性-ACID"><span class="nav-text">(1) 事务特性(ACID)</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-事务的创建"><span class="nav-text">(2) 事务的创建</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#3-并发一致性问题"><span class="nav-text">(3) 并发一致性问题</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#delete-和-truncate-在事务中的区别"><span class="nav-text">delete 和 truncate 在事务中的区别</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#五、-视图"><span class="nav-text">五、 视图</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#视图创建与修改"><span class="nav-text">视图创建与修改</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#视图更新"><span class="nav-text">视图更新</span></a></li></ol></li></ol><li class="nav-item nav-level-2"><a class="nav-link" href="#六、变量"><span class="nav-text">六、变量</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#系统变量"><span class="nav-text">系统变量</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#自定义变量"><span class="nav-text">自定义变量</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#七、存储过程和函数"><span class="nav-text">七、存储过程和函数</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#存储过程"><span class="nav-text">存储过程</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#创建语法"><span class="nav-text">创建语法</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#删除存储进程"><span class="nav-text">删除存储进程</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#查看存储过程信息"><span class="nav-text">查看存储过程信息</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#函数"><span class="nav-text">函数</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#创建函数"><span class="nav-text">创建函数</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#查看函数"><span class="nav-text">查看函数</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#流程控制结构"><span class="nav-text">流程控制结构</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#分支结构"><span class="nav-text">分支结构</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#循环"><span class="nav-text">循环</span></a></li></ol></li></ol></li></div></div></section></div></aside></div></main><footer id="footer" class="footer"><div class="footer-inner"><div class="copyright">&copy; <span itemprop="copyrightYear">2019</span> <span class="with-love"><i class="fa fa-user"></i> </span><span class="author" itemprop="copyrightHolder">Liang</span></div><div class="powered-by">由 <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a> 强力驱动</div><span class="post-meta-divider">|</span><div class="theme-info">主题 &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Gemini</a> v5.1.4</div></div></footer><div class="back-to-top"><i class="fa fa-arrow-up"></i></div></div><script type="text/javascript">"[object Function]"!==Object.prototype.toString.call(window.Promise)&&(window.Promise=null)</script><script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script><script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script><script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script><script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script><script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script><script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script><script type="text/javascript" src="/lib/canvas-nest/canvas-nest.min.js"></script><script type="text/javascript" src="/lib/three/three.min.js"></script><script type="text/javascript" src="/lib/three/canvas_lines.min.js"></script><script type="text/javascript" src="/lib/three/canvas_sphere.min.js"></script><script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script><script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script><script type="text/javascript" src="/js/src/affix.js?v=5.1.4"></script><script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.1.4"></script><script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.4"></script><script type="text/javascript" src="/js/src/post-details.js?v=5.1.4"></script><script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script><script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script><script src="//unpkg.com/valine/dist/Valine.min.js"></script><script type="text/javascript">var GUEST = ['nick','mail','link'];
    var guest = 'nick,mail,link';
    guest = guest.split(',').filter(item=>{
      return GUEST.indexOf(item)>-1;
    });
    new Valine({
        el: '#comments' ,
        verify: false,
        notify: false,
        appId: 'f7JF0rBv804AugR3Qlzdf7pn-gzGzoHsz',
        appKey: 'MGlHDt9joI6jLjPA69Qqs0bE',
        placeholder: 'Just go go',
        avatar:'mm',
        guest_info:guest,
        pageSize:'10' || 10,
    });</script><script type="text/javascript">function proceedsearch(){$("body").append('<div class="search-popup-overlay local-search-pop-overlay"></div>').css("overflow","hidden"),$(".search-popup-overlay").click(onPopupClose),$(".popup").toggle();var t=$("#local-search-input");t.attr("autocapitalize","none"),t.attr("autocorrect","off"),t.focus()}var isfetched=!1,isXml=!0,search_path="search.xml";0===search_path.length?search_path="search.xml":/json$/i.test(search_path)&&(isXml=!1);var path="/"+search_path,onPopupClose=function(t){$(".popup").hide(),$("#local-search-input").val(""),$(".search-result-list").remove(),$("#no-result").remove(),$(".local-search-pop-overlay").remove(),$("body").css("overflow","")},searchFunc=function(t,e,o){"use strict";$("body").append('<div class="search-popup-overlay local-search-pop-overlay"><div id="search-loading-icon"><i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i></div></div>').css("overflow","hidden"),$("#search-loading-icon").css("margin","20% auto 0 auto").css("text-align","center"),$.ajax({url:t,dataType:isXml?"xml":"json",async:!0,success:function(t){isfetched=!0,$(".popup").detach().appendTo(".header-inner");var n=isXml?$("entry",t).map(function(){return{title:$("title",this).text(),content:$("content",this).text(),url:$("url",this).text()}}).get():t,r=document.getElementById(e),s=document.getElementById(o),a=function(){var t=r.value.trim().toLowerCase(),e=t.split(/[\s\-]+/);e.length>1&&e.push(t);var o=[];if(t.length>0&&n.forEach(function(n){function r(e,o,n,r){for(var s=r[r.length-1],a=s.position,i=s.word,l=[],h=0;a+i.length<=n&&0!=r.length;){i===t&&h++,l.push({position:a,length:i.length});var p=a+i.length;for(r.pop();0!=r.length&&(s=r[r.length-1],a=s.position,i=s.word,p>a);)r.pop()}return c+=h,{hits:l,start:o,end:n,searchTextCount:h}}function s(t,e){var o="",n=e.start;return e.hits.forEach(function(e){o+=t.substring(n,e.position);var r=e.position+e.length;o+='<b class="search-keyword">'+t.substring(e.position,r)+"</b>",n=r}),o+=t.substring(n,e.end)}var a=!1,i=0,c=0,l=n.title.trim(),h=l.toLowerCase(),p=n.content.trim().replace(/<[^>]+>/g,""),u=p.toLowerCase(),f=decodeURIComponent(n.url),d=[],g=[];if(""!=l&&(e.forEach(function(t){function e(t,e,o){var n=t.length;if(0===n)return[];var r=0,s=[],a=[];for(o||(e=e.toLowerCase(),t=t.toLowerCase());(s=e.indexOf(t,r))>-1;)a.push({position:s,word:t}),r=s+n;return a}d=d.concat(e(t,h,!1)),g=g.concat(e(t,u,!1))}),(d.length>0||g.length>0)&&(a=!0,i=d.length+g.length)),a){[d,g].forEach(function(t){t.sort(function(t,e){return e.position!==t.position?e.position-t.position:t.word.length-e.word.length})});var v=[];0!=d.length&&v.push(r(l,0,l.length,d));for(var $=[];0!=g.length;){var C=g[g.length-1],m=C.position,x=C.word,w=m-20,y=m+80;w<0&&(w=0),y<m+x.length&&(y=m+x.length),y>p.length&&(y=p.length),$.push(r(p,w,y,g))}$.sort(function(t,e){return t.searchTextCount!==e.searchTextCount?e.searchTextCount-t.searchTextCount:t.hits.length!==e.hits.length?e.hits.length-t.hits.length:t.start-e.start});var T=parseInt("-1");T>=0&&($=$.slice(0,T));var b="";b+=0!=v.length?"<li><a href='"+f+"' class='search-result-title'>"+s(l,v[0])+"</a>":"<li><a href='"+f+"' class='search-result-title'>"+l+"</a>",$.forEach(function(t){b+="<a href='"+f+'\'><p class="search-result">'+s(p,t)+"...</p></a>"}),b+="</li>",o.push({item:b,searchTextCount:c,hitCount:i,id:o.length})}}),1===e.length&&""===e[0])s.innerHTML='<div id="no-result"><i class="fa fa-search fa-5x" /></div>';else if(0===o.length)s.innerHTML='<div id="no-result"><i class="fa fa-frown-o fa-5x" /></div>';else{o.sort(function(t,e){return t.searchTextCount!==e.searchTextCount?e.searchTextCount-t.searchTextCount:t.hitCount!==e.hitCount?e.hitCount-t.hitCount:e.id-t.id});var a='<ul class="search-result-list">';o.forEach(function(t){a+=t.item}),a+="</ul>",s.innerHTML=a}};r.addEventListener("input",a),$(".local-search-pop-overlay").remove(),$("body").css("overflow",""),proceedsearch()}})};$(".popup-trigger").click(function(t){t.stopPropagation(),isfetched===!1?searchFunc(path,"local-search-input","local-search-result"):proceedsearch()}),$(".popup-btn-close").click(onPopupClose),$(".popup").click(function(t){t.stopPropagation()}),$(document).on("keyup",function(t){var e=27===t.which&&$(".search-popup").is(":visible");e&&onPopupClose()})</script><script>!function(){var t=document.createElement("script"),s=window.location.protocol.split(":")[0];"https"===s?t.src="https://zz.bdstatic.com/linksubmit/push.js":t.src="http://push.zhanzhang.baidu.com/push.js";var e=document.getElementsByTagName("script")[0];e.parentNode.insertBefore(t,e)}()</script><script type="text/x-mathjax-config">MathJax.Hub.Config({
        tex2jax: {
          inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
          processEscapes: true,
          skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
        }
      });</script><script type="text/x-mathjax-config">MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax(), i;
        for (i=0; i < all.length; i += 1) {
          all[i].SourceElement().parentNode.className += ' has-jax';
        }
      });</script><script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML"></script><script type="text/javascript" src="/js/src/love.js"></script><script type="text/javascript" src="/js/src/snow.js"></script><script type="text/javascript" src="/js/src/clipboard.min.js"></script><script type="text/javascript" src="/js/src/clipboard-use.js"></script></body></html><!-- rebuild by neat -->